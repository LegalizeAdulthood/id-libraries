comment { ; narrative copyright Kerry Mitchell 11sep98

Embossing

Notary Publics and other important folks use embossing as a way of
marking official papers.  The embossing die puts a series of crimps
onto the paper.  This doesn't change the color of the paper, but
makes hills and valleys that are visible as highlights and shadows.
The "embossing" coloring method has a similar effect.  Typically, the
majority of the image is a middle gray.  Contour bands (such as those
between regions of constant dwell) are colored black and white,
resembling shadows and highlights, respectively.  Performed correctly,
this gives a very convincing 3D effect to the image, reminiscent of a
topographical map or architectural model.

In general, embossing requires 2 test points for each pixel, and
some discrete variable (call it D for this explanation).  If D is the
same for both test points (D1 = D2), then the pixel is colored middle
gray.  If D for the first test point is less than D for the second
point (D1 < D2), then the pixel is colored black.  Otherwise, D1 > D2,
and the pixel is colored white.  For example (B = black, W = white,
G = gray):

D1 (first test point):   1  23  45   2   5   9  34   0   1  19
D2 (second test point):  1  22  45   2   5  10  34   0   2  18
pixel color:             G   W   G   G   G   B   G   G   B   W

In the present method, the test points are placed on either side of
the pixel.  Exactly where is determined by 2 parameters, the "size"
and "lightangle".  The apparant size of the contour bands in the
image depends on how far apart the test points are, related to "size".
Using a larger size will result in bigger, more dramatic bands.
However, using large bands, particularly with decomp turned off, can
lead to "seeing double" in your fractal.  Typically, size=0.005 to
0.01 works well for full-scale images (magnification=0.66667), and
it should be decreased as the magnification increases.

The relative location of the highlights and shadows on a real embossed
sheet depends on from where the light is coming.  This is simulated
with the "lightangle" parameter.  Using a value of 0 would show
highlights on the right side (0 degrees) and shadows on the left side
(180 degrees).  The highlights generally appear in the same direction
given by lightangle; the shadows are generally on the other side, 180
degrees away.

The discrete variable used here is the iteration number:  how many
iterations before the orbits escape.  Colors are determined by assigning
z one of 4 values, each of which has a different polar angle.  Then,
using "decomp=256" coloring will make each case show up clearly.  If
both test points have escaping orbits, then the pixel is colored one
color (z = "black") if the 1st point escapes first, a 2nd color
("white") if the 2nd point escapes first, and a 3rd color ("gray")
if they both escape on the same iteration.  If both orbits don't escape
before the maximum number of iterations is reached, then the pixel is
colored using a 4th color (z = "other").  Of course, the colors that
actually show up in your image will depend on your color palette.

To add more flexibility, an elliptical bailout condition is used.  In
a typical Mandelbrot calculation, iteration ceases when |z| > bailout,
which means

        [real(z)]^2 + [imag(z)]^2 > bailout.

This gives a bailout boundary that is a circle.  By changing the
relative weights of real(z) and imag(z):

        [a*real(z)]^2 + [b*imag(z)]^2 > bailout,

the bailout boundary is changed to an ellipse.  The relative sizes
of a and b will determine the eccentricity of the ellipse (long vs.
circular vs. tall), and the minimum of a and b will determine how
big the bailout ellipse is.  For example, small a and large b would
weigh the imaginary part more heavily in the bailout determination.
For best results, a and b should both be <= 1.  This method also uses
the "strict" bailout condition:  if a and b are both = 1, then the
bailout radius depends on the magnitude of c.  This brings the
iteration contours closer together when c is small.  Since this
method emphasizes the contours so much, the more precise condition
was chosen.

Other discrete quantities can be used in this method, and continuous
variables can be made discrete by using the round() and trunc()
functions.  But this is work for another time.  Until then, play
notary public in your own fractal jurisdiction and emboss away!

}

embossed-mandelbrot { ; copyright Kerry Mitchell 11sep98
  ;
  ;  most of the image is middle gray
  ;  highlights are white, shadows are black
  ;  interior (non-escaping) uses "other" color
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_man passes=1 center-mag=-0.6/0/0.8
  params=1/1/0.005/180 float=y maxiter=256 inside=0 decomp=256
  periodicity=0 colors=000w00<60>w00VVVw00<61>w00zzzw00<62>w0\
  000ww00<61>w00 cyclerange=0/255
  }

embossed-julia { ; copyright Kerry Mitchell 11sep98
  ;
  ;  most of the image is middle gray
  ;  highlights are white, shadows are black
  ;  interior (non-escaping) uses "other" color
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_jul passes=1 center-mag=0/0/1/1/80
  params=0.44/0.23/0.7/0.7/0.003/40 float=y maxiter=256 inside=0
  decomp=256 periodicity=0 colors=000w00<60>w00VVVw00<61>w00zzz\
  w00<62>w0000ww00<61>w00 cyclerange=0/255
  }

bowtie { ; copyright Kerry Mitchell 11sep98
  ;
  ;  embossed images don't have to be just black, white
  ;  and gray, ya know...
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_jul passes=1 center-mag=0/0/0.6
  params=-2/0/1/0.5/0.1/0 float=y maxiter=256 inside=0
  decomp=256 periodicity=0 colors=00zw00<60>w00zzzw00<61>\
  w00z00w00<62>w0000ww00<61>w00 cyclerange=0/255
  }

breakers-on-midget-isle { ; copyright Kerry Mitchell 11sep98
  ;
  ;  embossed images don't have to be just black, white
  ;  and gray, ya know...
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_man passes=1 center-mag=-1.766/0/13
  params=0.15/0.45/0.0003/150 float=y maxiter=256 inside=0
  decomp=256 periodicity=0 colors=000w00<60>w000Umw00<61>w00\
  zzzw00<62>w000U0w00<61>w00 cyclerange=0/255
  }

seeing-double { ; copyright Kerry Mitchell 11sep98
  ;
  ;  what can happen if the "size" parameter is set too big
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_man center-mag=-0.782848/0.147517/\
  235/1/-52.5 params=1/1/0.001/60 float=y maxiter=256 inside=0
  periodicity=0 colors=0xz<18>04z01z00y<20>000<20>z00<20>zz0<\
  19>zzvzzyyzz<20>0zz<20>00z<19>003000200<18>v00y00z10<20>zz0\
  <20>zzzzzz<20>0zz cyclerange=0/255
  }

newton4 { ; copyright Kerry Mitchell 14sep98
  ;
  ; embossed 4th-order Newton
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_newtn passes=1 center-mag=0/-1.23/5
  params=0.001/4/0.0006/90 float=y maxiter=256 inside=0
  decomp=256 periodicity=0 colors=000w00<60>w00VVVw00<61>w00\
  zzzw00<62>w0000ww00<61>w00 cyclerange=0/255
  }

newton8 { ; copyright Kerry Mitchell 14sep98
  ;
  ; embossed 8th-order Newton
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_newtn passes=1 center-mag=0/0/0.75
  params=0.001/8/0.003/180 float=y maxiter=256 inside=0 decomp=256
  periodicity=0 colors=000w00<60>w00VVVw00<61>w00zzzw00<62>w0000\
  ww00<61>w00 cyclerange=0/255
  }

newton-explog  { ; copyright Kerry Mitchell 10oct98
  ;
  ; embossed Newton for exp(z) = log(z)
  ;
  reset=1960 type=formula formulafile=emboss.frm
  formulaname=emboss-iter_newtex passes=1 center-mag=0.7/0/5
  params=0.001/0/0.0005/180 float=y maxiter=2000 inside=0 decomp=256
  periodicity=0 colors=000w00<60>w00VVVw00<61>w00zzzw00<62>w0000ww0\
  0<61>w00 cyclerange=0/255
  }

